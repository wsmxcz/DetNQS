name: lever
channels:
  - nvidia
  - conda-forge
channel_priority: strict

dependencies:
  # --- Core ---
  - python=3.13
  - pip

  # --- BuildBuild toolchain ---
  - cmake>=3.28,<3.31
  - ninja
  - c-compiler
  - cxx-compiler
  - pkg-config
  - nanobind>=2.8
  - scikit-build-core>=0.10
  - eigen
  - openmp
  - catch2

  # --- CUDA Toolkit (complete toolchain: nvcc + nvvm + cicc etc.) ---
  # Pin to 12.9 for RTX 50 (Blackwell) + A100/H100 compatibility
  - cuda=12.9
  - mathdx=25.06.0
  
  # Optional (if you want conda-provided cuDNN too; JAX pip path can also pull cuDNN wheels)
  - cudnn>=9

  # --- Python numerics / dev ---
  - numpy>=2.1
  - scipy>=1.14
  - pytest
  - pytest-benchmark
  - ipykernel
  - matplotlib
  - pandas

  # --- JAX / ML stack via pip (newer than conda-forge, and CUDA deps handled) ---
  - pip:
      - "jax[cuda_12]>=0.8.1"
      - "flax>=0.12"
      - "optax>=0.2"